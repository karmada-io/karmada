# test case for interpreting status of HelmRelease
# case1. HelmRelease: interpret status test
# case2. HelmRelease with nil status should return empty status
# case3. HelmRelease with partial status fields

name: "HelmRelease: interpret status test"
description: "Test interpreting status for HelmRelease with complete status"
observedObj:
  apiVersion: helm.toolkit.fluxcd.io/v2beta1
  kind: HelmRelease
  metadata:
    annotations:
      resourcetemplate.karmada.io/generation: "1"
    name: sample
    namespace: default
    generation: 1
  status:
    conditions:
      - lastTransitionTime: "2023-05-01T07:11:16Z"
        message: Release reconciliation succeeded
        reason: ReconciliationSucceeded
        status: "True"
        type: Ready
      - lastTransitionTime: "2023-05-01T07:11:16Z"
        message: Helm install succeeded
        reason: InstallSucceeded
        status: "True"
        type: Released
    helmChart: test-helmrelease/test-helmrelease-sample
    lastAppliedRevision: 6.3.5
    lastAttemptedRevision: 6.3.5
    lastAttemptedValuesChecksum: da39a3ee5e6b4b0d3255bfef95601890afd80709
    lastReleaseRevision: 1
    observedGeneration: 1
    failures: 0
    upgradeFailures: 0
    installFailures: 0
operation: InterpretStatus
output:
  status:
    conditions:
      - lastTransitionTime: "2023-05-01T07:11:16Z"
        message: Release reconciliation succeeded
        reason: ReconciliationSucceeded
        status: "True"
        type: Ready
      - lastTransitionTime: "2023-05-01T07:11:16Z"
        message: Helm install succeeded
        reason: InstallSucceeded
        status: "True"
        type: Released
    helmChart: test-helmrelease/test-helmrelease-sample
    lastAppliedRevision: 6.3.5
    lastAttemptedRevision: 6.3.5
    lastAttemptedValuesChecksum: da39a3ee5e6b4b0d3255bfef95601890afd80709
    lastReleaseRevision: 1
    observedGeneration: 1
    failures: 0
    upgradeFailures: 0
    installFailures: 0
    generation: 1
    resourceTemplateGeneration: 1

---
name: "HelmRelease with nil status should return empty status"
description: "Test interpreting status when HelmRelease has nil status"
observedObj:
  apiVersion: helm.toolkit.fluxcd.io/v2beta1
  kind: HelmRelease
  metadata:
    name: sample
    namespace: default
    generation: 1
operation: InterpretStatus
output:
  status: {}

---
name: "HelmRelease with partial status fields"
description: "Test interpreting status when HelmRelease has partial status fields"
observedObj:
  apiVersion: helm.toolkit.fluxcd.io/v2beta1
  kind: HelmRelease
  metadata:
    name: sample
    namespace: default
    generation: 1
  status:
    conditions:
      - type: Ready
        status: "True"
        reason: ReconciliationSucceeded
    observedGeneration: 1
    lastAttemptedRevision: 6.3.5
operation: InterpretStatus
output:
  status:
    conditions:
      - type: Ready
        status: "True"
        reason: ReconciliationSucceeded
    observedGeneration: 1
    lastAttemptedRevision: 6.3.5
    generation: 1
