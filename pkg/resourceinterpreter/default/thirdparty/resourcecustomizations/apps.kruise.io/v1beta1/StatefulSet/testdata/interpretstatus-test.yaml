# test case for interpreting status of StatefulSet
# case1. StatefulSet: interpret status test
# case2. StatefulSet interpret status without resourceTemplateGeneration annotation

name: "StatefulSet: interpret status test"
description: "Test interpreting status for StatefulSet"
observedObj:
  apiVersion: apps.kruise.io/v1beta1
  kind: StatefulSet
  metadata:
    annotations:
      resourcetemplate.karmada.io/generation: "1"
    name: sample
    namespace: test-statefulset
    generation: 1
  spec:
    replicas: 2
    serviceName: sample-statefulset-headless-service
    selector:
      matchLabels:
        app: sample
    template:
      metadata:
        labels:
          app: sample
      spec:
        volumes:
          - name: configmap
            configMap:
              name: my-sample-config
        readinessGates:
          - conditionType: InPlaceUpdateReady
        containers:
          - name: nginx
            image: nginx:alpine
            ports:
              - containerPort: 80
                name: web
            env:
              - name: logData
                valueFrom:
                  configMapKeyRef:
                    name: mysql-config
                    key: log
              - name: lowerData
                valueFrom:
                  configMapKeyRef:
                    name: mysql-config
                    key: lower
    podManagementPolicy: Parallel
    updateStrategy:
      type: RollingUpdate
      rollingUpdate:
        podUpdatePolicy: InPlaceIfPossible
        maxUnavailable: 2
  status:
    availableReplicas: 2
    collisionCount: 0
    currentReplicas: 2
    currentRevision: sample-5675547df7
    labelSelector: app=sample
    observedGeneration: 1
    readyReplicas: 2
    replicas: 2
    updateRevision: sample-5675547df7
    updatedReadyReplicas: 2
    updatedReplicas: 2
operation: InterpretStatus
output:
  status:
    replicas: 2
    readyReplicas: 2
    currentReplicas: 2
    updatedReplicas: 2
    availableReplicas: 2
    updatedReadyReplicas: 2
    updateRevision: sample-5675547df7
    currentRevision: sample-5675547df7
    observedGeneration: 1
    generation: 1
    resourceTemplateGeneration: 1
---
name: "StatefulSet interpret status without resourceTemplateGeneration annotation"
description: "InterpretStatus without resourcetemplate annotation"
observedObj:
  apiVersion: apps.kruise.io/v1beta1
  kind: StatefulSet
  metadata:
    name: sample
    namespace: test-statefulset
    generation: 2
  status:
    replicas: 3
    readyReplicas: 2
    currentReplicas: 3
    updatedReplicas: 3
    availableReplicas: 2
    updatedReadyReplicas: 2
    observedGeneration: 2
operation: InterpretStatus
output:
  status:
    replicas: 3
    readyReplicas: 2
    currentReplicas: 3
    updatedReplicas: 3
    availableReplicas: 2
    updatedReadyReplicas: 2
    observedGeneration: 2
    generation: 2
