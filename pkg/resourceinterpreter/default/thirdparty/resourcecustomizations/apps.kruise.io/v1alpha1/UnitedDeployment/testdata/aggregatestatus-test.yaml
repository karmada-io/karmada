# test case for aggregating status of UnitedDeployment
# case1. UnitedDeployment with two status items

name: "UnitedDeployment with two status items"
description: "Test aggregating status of UnitedDeployment with two status items"
desiredObj:
  apiVersion: apps.kruise.io/v1alpha1
  kind: UnitedDeployment
  metadata:
    name: sample-uniteddeployment
    namespace: test-namespace
    generation: 1
  spec:
    replicas: 3
    selector:
      matchLabels:
        app: sample
    template:
      metadata:
        labels:
          app: sample
      spec:
        containers:
          - name: nginx
            image: nginx:latest
            env:
              - name: CONFIG_DATA
                valueFrom:
                  configMapKeyRef:
                    name: app-config
                    key: config
              - name: SECRET_DATA
                valueFrom:
                  secretKeyRef:
                    name: app-secret
                    key: token
            volumeMounts:
              - name: config-volume
                mountPath: /etc/config
        volumes:
          - name: config-volume
            configMap:
              name: app-config
    topologySpread:
      - topologyKey: kubernetes.io/hostname
        maxSkew: 1
statusItems:
  - apiVersion: apps.kruise.io/v1alpha1
    kind: UnitedDeployment
    metadata:
      name: sample-uniteddeployment
      namespace: test-namespace
      clusterName: member1
    status:
      replicas: 2
      readyReplicas: 2
      updatedReplicas: 2
      availableReplicas: 2
      collisionCount: 0
      observedGeneration: 1
  - apiVersion: apps.kruise.io/v1alpha1
    kind: UnitedDeployment
    metadata:
      name: sample-uniteddeployment
      namespace: test-namespace
      clusterName: member2
    status:
      replicas: 1
      readyReplicas: 1
      updatedReplicas: 1
      availableReplicas: 1
      collisionCount: 0
      observedGeneration: 1
operation: AggregateStatus
output:
