# test case for aggregating status of RayCluster
# case1. RayCluster with two status items

name: "RayCluster with two status items"
description: "Test aggregating status of RayCluster with two status items"
desiredObj:
  apiVersion: ray.io/v1
  kind: RayCluster
  metadata:
    name: sample
  spec:
    rayVersion: '2.46.0'
    headGroupSpec:
      rayStartParams: { }
      template:
        spec:
          containers:
            - name: ray-head
              image: rayproject/ray:2.46.0
              resources:
                limits:
                  cpu: 1
                  memory: 2G
                requests:
                  cpu: 1
                  memory: 2G
              ports:
                - containerPort: 6379
                  name: gcs-server
                - containerPort: 8265
                  name: dashboard
                - containerPort: 10001
                  name: client
    workerGroupSpecs:
      - replicas: 1
        minReplicas: 1
        maxReplicas: 5
        groupName: workergroup
        rayStartParams: { }
        template:
          spec:
            containers:
              image: rayproject/ray:2.46.0
              resources:
                limits:
                  cpu: 1
                  memory: 1G
                requests:
                  cpu: 1
                  memory: 1G
statusItems:
  - applied: true
    clusterName: member1
    status:
      availableWorkerReplicas: 1
      conditions:
        - lastTransitionTime: "2025-09-21T03:55:30Z"
          message: ""
          reason: HeadPodRunningAndReady
          status: "True"
          type: HeadPodReady
        - lastTransitionTime: "2025-09-21T03:55:45Z"
          message: All Ray Pods are ready for the first time
          reason: AllPodRunningAndReadyFirstTime
          status: "True"
          type: RayClusterProvisioned
        - lastTransitionTime: "2025-09-21T03:54:44Z"
          message: ""
          reason: RayClusterSuspended
          status: "False"
          type: RayClusterSuspended
        - lastTransitionTime: "2025-09-21T03:54:44Z"
          message: ""
          reason: RayClusterSuspending
          status: "False"
          type: RayClusterSuspending
      desiredCPU: "2"
      desiredGPU: "0"
      desiredMemory: 3G
      desiredTPU: "0"
      desiredWorkerReplicas: 1
      endpoints:
        client: "10001"
        dashboard: "8265"
        gcs-server: "6379"
        metrics: "8080"
      head:
        podIP: 10.244.0.6
        podName: sample-head-9cvfc
        serviceIP: 10.244.0.6
        serviceName: sample-head-svc
      lastUpdateTime: "2025-09-21T03:55:45Z"
      maxWorkerReplicas: 5
      minWorkerReplicas: 1
      observedGeneration: 1
      readyWorkerReplicas: 1
      state: ready
      stateTransitionTimes:
        ready: "2025-09-21T03:55:45Z"
  - applied: true
    clusterName: member2
    status:
      availableWorkerReplicas: 2
      conditions:
        - lastTransitionTime: "2025-09-21T03:56:30Z"
          message: ""
          reason: HeadPodRunningAndReady
          status: "True"
          type: HeadPodReady
        - lastTransitionTime: "2025-09-21T03:56:50Z"
          message: All Ray Pods are ready for the first time
          reason: AllPodRunningAndReadyFirstTime
          status: "True"
          type: RayClusterProvisioned
        - lastTransitionTime: "2025-09-21T03:54:50Z"
          message: ""
          reason: RayClusterSuspended
          status: "False"
          type: RayClusterSuspended
        - lastTransitionTime: "2025-09-21T03:54:50Z"
          message: ""
          reason: RayClusterSuspending
          status: "False"
          type: RayClusterSuspending
      desiredCPU: "4"
      desiredGPU: "1"
      desiredMemory: 5G
      desiredTPU: "0"
      desiredWorkerReplicas: 3
      lastUpdateTime: "2025-09-21T03:56:50Z"
      maxWorkerReplicas: 10
      minWorkerReplicas: 2
      observedGeneration: 2
      readyWorkerReplicas: 3
      state: ready
      stateTransitionTimes:
        ready: "2025-09-21T03:56:50Z"
operation: AggregateStatus
output:
